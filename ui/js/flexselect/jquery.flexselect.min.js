(function(e){e.flexselect=function(e,t){this.init(e,t)};e.extend(e.flexselect.prototype,{settings:{allowMismatch:false,allowMismatchBlank:true,sortBy:"score",preSelection:true,hideDropdownOnEmptyInput:false,selectedClass:"flexselect_selected",dropdownClass:"flexselect_dropdown",inputIdTransform:function(e){return e+"_flexselect"},inputNameTransform:function(e){return},dropdownIdTransform:function(e){return e+"_flexselect_dropdown"}},select:null,input:null,dropdown:null,dropdownList:null,cache:[],results:[],lastAbbreviation:null,abbreviationBeforeFocus:null,selectedIndex:0,picked:false,allowMouseMove:true,dropdownMouseover:false,init:function(t,n){this.settings=e.extend({},this.settings,n);this.select=e(t);this.preloadCache();this.renderControls();this.wire()},preloadCache:function(){this.cache=this.select.find("option").map(function(){return{name:e.trim(e(this).text()),value:e(this).val(),score:0}})},renderControls:function(){var t=this.settings.preSelection?this.select.find("option:selected"):null;this.input=e("<input type='text' autocomplete='off' />").attr({id:this.settings.inputIdTransform(this.select.attr("id")),name:this.settings.inputNameTransform(this.select.attr("name")),accesskey:this.select.attr("accesskey"),tabindex:this.select.attr("tabindex"),style:this.select.attr("style"),placeholder:this.select.attr("data-placeholder")}).addClass(this.select.attr("class")).val(e.trim(t?t.text():"")).css({visibility:"visible"});this.dropdown=e("<div></div>").attr({id:this.settings.dropdownIdTransform(this.select.attr("id"))}).addClass(this.settings.dropdownClass);this.dropdownList=e("<ul></ul>");this.dropdown.append(this.dropdownList);this.select.after(this.input).hide();e("body").append(this.dropdown)},wire:function(){var t=this;this.input.click(function(){t.lastAbbreviation=null;t.focus()});this.input.mouseup(function(e){e.preventDefault()});this.input.focus(function(){t.abbreviationBeforeFocus=t.input.val();t.input.select();if(!t.picked)t.filterResults()});this.input.blur(function(){if(!t.dropdownMouseover){t.hide();if(t.settings.allowMismatchBlank&&e.trim(e(this).val())=="")t.setValue("");if(!t.settings.allowMismatch&&!t.picked)t.reset()}if(t.settings.hideDropdownOnEmptyInput)t.dropdownList.show()});this.dropdownList.mouseover(function(n){if(!t.allowMouseMove){t.allowMouseMove=true;return}if(n.target.tagName=="LI"){var r=t.dropdown.find("li");t.markSelected(r.index(e(n.target)))}});this.dropdownList.mouseleave(function(){t.markSelected(-1)});this.dropdownList.mouseup(function(e){t.pickSelected();t.focusAndHide()});this.dropdown.mouseover(function(e){t.dropdownMouseover=true});this.dropdown.mouseleave(function(e){t.dropdownMouseover=false});this.dropdown.mousedown(function(e){e.preventDefault()});this.input.keyup(function(e){switch(e.keyCode){case 13:e.preventDefault();t.pickSelected();t.focusAndHide();break;case 27:e.preventDefault();t.reset();t.focusAndHide();break;default:t.filterResults();break}if(t.settings.hideDropdownOnEmptyInput){if(t.input.val()=="")t.dropdownList.hide();else t.dropdownList.show()}});this.input.keydown(function(e){switch(e.keyCode){case 9:t.pickSelected();t.hide();break;case 33:e.preventDefault();t.markFirst();break;case 34:e.preventDefault();t.markLast();break;case 38:e.preventDefault();t.moveSelected(-1);break;case 40:e.preventDefault();t.moveSelected(1);break;case 13:case 27:e.preventDefault();e.stopPropagation();break}});var n=this.input;this.select.change(function(){n.val(e.trim(e(this).find("option:selected").text()))})},filterResults:function(){var t=this.input.val();if(t==this.lastAbbreviation)return;var n=[];e.each(this.cache,function(){this.score=LiquidMetal.score(this.name,t);if(this.score>0)n.push(this)});this.results=n;if(this.settings.sortBy=="score")this.sortResultsByScore();else if(this.settings.sortBy=="name")this.sortResultsByName();this.renderDropdown();this.markFirst();this.lastAbbreviation=t;this.picked=false;this.allowMouseMove=false},sortResultsByScore:function(){this.results.sort(function(e,t){return t.score-e.score})},sortResultsByName:function(){this.results.sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})},renderDropdown:function(){var t=this.dropdown.outerWidth()-this.dropdown.innerWidth();var n=this.input.offset();this.dropdown.css({width:this.input.outerWidth()-t+"px",top:n.top+this.input.outerHeight()+"px",left:n.left+"px",maxHeight:""});var r="";e.each(this.results,function(){r+="<li>"+this.name+"</li>"});this.dropdownList.html(r);this.adjustMaxHeight();this.dropdown.show()},adjustMaxHeight:function(){var t=e(window).height()+e(window).scrollTop()-this.dropdown.outerHeight();var n=parseInt(this.dropdown.css("top"),10);this.dropdown.css("max-height",n>t?Math.max(0,t-n+this.dropdown.innerHeight())+"px":"")},markSelected:function(t){if(t<0||t>=this.results.length)return;var n=this.dropdown.find("li");n.removeClass(this.settings.selectedClass);this.selectedIndex=t;var r=e(n[t]).addClass(this.settings.selectedClass);var i=r.position().top;var s=i+r.outerHeight()-this.dropdown.height();if(s>0){this.allowMouseMove=false;this.dropdown.scrollTop(this.dropdown.scrollTop()+s)}else if(i<0){this.allowMouseMove=false;this.dropdown.scrollTop(Math.max(0,this.dropdown.scrollTop()+i))}},pickSelected:function(){var e=this.results[this.selectedIndex];if(e){this.input.val(e.name);this.setValue(e.value);this.picked=true}else if(this.settings.allowMismatch){this.setValue.val("")}else{this.reset()}},setValue:function(e){if(this.select.val()===e)return;this.select.val(e).change()},hide:function(){this.dropdown.hide();this.lastAbbreviation=null},moveSelected:function(e){this.markSelected(this.selectedIndex+e)},markFirst:function(){this.markSelected(0)},markLast:function(){this.markSelected(this.results.length-1)},reset:function(){this.input.val(this.abbreviationBeforeFocus)},focus:function(){this.input.focus()},focusAndHide:function(){this.focus();this.hide()}});e.fn.flexselect=function(t){this.each(function(){if(this.tagName=="SELECT")new e.flexselect(this,t)});return this}})(jQuery);var LiquidMetal=function(){function o(e,t){var n=e.charAt(t);return"A"<=n&&n<="Z"}function u(e,t){var n=e.charAt(t-1);return s.indexOf(n)!=-1}function a(e,t,n,r){for(var i=n;i<r;i++){e[i]=t}return e}var e=0;var t=1;var n=.8;var r=.9;var i=.85;var s=" 	_-";return{lastScore:null,lastScoreArray:null,score:function(t,r){if(r.length===0)return n;if(r.length>t.length)return e;var i=[];var s=t.toLowerCase();r=r.toLowerCase();this._scoreAll(t,s,r,-1,0,[],i);if(i.length==0)return 0;var o=0,u=[];for(var a=0;a<i.length;a++){var f=i[a];var l=0;for(var c=0;c<t.length;c++){l+=f[c]}if(l>o){o=l;u=f}}o/=t.length;this.lastScore=o;this.lastScoreArray=u;return o},_scoreAll:function(s,f,l,c,h,p,d){if(h==l.length){var v=f.charAt(0)==l.charAt(0);var m=v?r:n;a(p,m,p.length,s.length);d.push(p.slice(0));return}var g=l.charAt(h);h++;var y=f.indexOf(g,c);if(y==-1)return;var b=c;while((y=f.indexOf(g,c+1))!=-1){if(u(s,y)){p[y-1]=1;a(p,i,b+1,y-1)}else if(o(s,y)){a(p,i,b+1,y)}else{a(p,e,b+1,y)}p[y]=t;c=y;this._scoreAll(s,f,l,c,h,p,d)}}}}()